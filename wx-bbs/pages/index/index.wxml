
<import src="/template/postlist"/>
<import src="/template/emoij"/>
<view class="body">
  <view class="border-slice zindex-2">
    <view class="head zindex-2">
      <view class="index-head-logo zindex-2">
        <image class="index-head-logo-img" src="{{headInfo.logoUrl}}"></image>
        <text class="index-head-logo-f">
          话题  {{headInfo.articleCount}} | 访问 {{headInfo.clickCount}}
        </text>
      </view>
      <view class="head-banner" style="background:url({{headInfo.backMap}}) no-repeat"></view>
    </view>
    <view class="index-head-bottom zindex-2">
          <view wx:if="{{user.IsSign == false}}" class="flex zindex-2" catchtap="sign"><view class="index-sign"></view>签到</view>
          <view wx:else="{{user.IsSign == true}}" class="flex zindex-2">已签到</view>
          <view class="flex zindex-2" catchtap="concern"><view class="index-focus zindex-2"></view>关注</view>
    </view>
    <view class="head-announcement zindex-2">
      <view><view class="announcement-icon02 zindex-2"></view><text></text></view>
      <view><view class="announcement-icon02 zindex-2"></view><view></view></view>
    </view>
  </view>
  <view class="index-heading-scrol zindex-2">
    <scroll-view class="index-heading-content zindex-2" scroll-x="true" scroll-left="{{scrollLeft}}" style="width:100%">

      <view  class="bankuai zindex-2 {{currentTypeId==0&&hot==0?'selected':''}}"  catchtap="toBankuai" data-typeid="0"><text>全部</text></view>

      <view  class="bankuai zindex-2 {{currentTypeId==0&&hot==1?'selected':''}}" catchtap="toBankuai" data-typeid="0" data-hot="1"><text>热帖</text></view>

      <block wx:for="{{categories}}" wx:for-item="category" wx:key="Id">
        <view wx:if="{{category.Id != 0}}" class="bankuai zindex-2 {{ currentTypeId==category.Id?'selected':''}}" catchtap="toBankuai" data-typeid="{{category.Id}}">
            <text class="zindex-2">{{category.Title}}</text>
        </view>
      </block>
    </scroll-view>
    <view class="index-heading-more zindex-2"  catchtap="moreType" >+</view>
  </view>
  <view class="fix-index-heading-scrol zindex-1">
    <scroll-view class="index-heading-content zindex-1" scroll-x="true" scroll-left="{{scrollLeft}}" style="width:100%">

      <view  class="bankuai zindex-1 {{currentTypeId==0&&hot==0?'selected':''}}"  catchtap="toBankuai" data-typeid="0"><text class="zindex-1">全部</text></view>

      <view  class="bankuai zindex-1 {{currentTypeId==0&&hot==1?'selected':''}}" catchtap="toBankuai" data-typeid="0" data-hot="1"><text class="zindex-1">热帖</text></view>

      <block wx:for="{{categories}}" wx:for-item="category" wx:key="Id">
        <view wx:if="{{category.Id != 0}}" class="bankuai zindex-1 {{ currentTypeId==category.Id?'selected':''}}" catchtap="toBankuai" data-typeid="{{category.Id}}">
            <text class="zindex-1">{{category.Title}}</text>
        </view>
      </block>
    </scroll-view>
    <view class="index-heading-more zindex-1" catchtap="moreType" >+</view>
  </view>
  <view class="scrollview-hide"></view>
  <!-- 帖子内容 -->
  <view class="art-content" scroll-y="true" scroll-x="false" 
  bindscrolltolower="nextPage" data-page-index="{{pageIndex}}" style="width:100%;">
    <block wx:for="{{articles}}" wx:for-index="idx" wx:for-item="item" wx:key="Id">
      <view class="border-slice">
        <!-- 贴主信息-->
        <template is="post-head" data="{{...item}}"/>
        <view style="clear:both"></view>
        <!-- 帖子正文 -->
        <view>
          <template is="post-content" data="{{...item}}"/>
          <!-- 转评赞 -->
          <template is="share" data="{{...item}}"/>
        </view>
         <!-- 赞赏头像 -->
        <template is="rewardimgs" data="{{...item}}"/>
        <!-- 点赞头像-->
        <template is="praiseimgs" data="{{...item}}"/>
        <!-- 回复信息 -->
        <view wx:if="{{item.articleComments}}" class="comment-container">
        <view style="width:7%"><view class="comment-icon"></view></view>
        <view class="comment-content"> 
            <block wx:for="{{item.articleComments}}" wx:for-item="comment" wx:key="Id" wx:if="{{index < 3 || currentMoreComment == item.Id}}">
            <view class="res-info">
                <!-- 头像 -->
                <template is="commentimg" data="{{...comment}}"></template>
                <view class="comment-content-msg-wrap" catchtap="commentUser" data-id="{{comment.Id}}"
                data-uid="{{comment.ComUser.Id}}" data-name="{{comment.ComUser.NickName}}" data-artid="{{item.Id}}">
                    <template is="commentcontent" data="{{...comment}}" />
                </view>
            </view>
            </block>
        </view>
        </view>
        <view wx:if="{{item.CommentCount>3 && currentMoreComment != item.Id}}" style="clear:both" class="more-comments" data-id="{{item.Id}}" catchtap = "moreComment">查看更多{{item.CommentCount}}信息</view>

          <!-- 评论帖子 -->
           <view wx:if="{{showRecommend.id==item.Id}}" class="recommend-container" >
            <view>
            <!-- 图片 -->
                <!-- 发帖图片 -->
                <view style="margin:12px;">
                    <block wx:for="{{selectedImgs}}" wx:for-item="imgs">
                        <view style="position:relative;max-height:80px; width:20%; margin:5px; display:inline-block; vertical-align:middel">
                            <view class="img-remove" data-id="{{imgs.id}}" catchtap="removeImg"></view>
                            <image style="width:100%;max-height:80px;" src="{{imgs.src}}"/>
                        </view>
                    </block>
                </view>
                <view style="width:100%; padding:5px;border: 1px solid #d6d6d6;background-color:#fff">
                    <!--<textarea bindfocus="saveTextValue" class="recommend-text" placeholder="{{showRecommend.toUserName?'回复'+showRecommend.toUserName+':':'回复帖子:'}}" value="{{commentText}}" bindblur="saveTextValue"></textarea>-->
                    <input bindinput="saveTextValue" class="recommend-text" placeholder="{{showRecommend.toUserName?'回复'+showRecommend.toUserName+':':'回复帖子:'}}" value="{{commentText}}"/>
                </view>
                <view class="recommend-line-container">
                     <view class="recommend-icon-container">
                         <view class="recommend-emoij-wrap recommend-wrap" catchtap="selectEmoij" data-id="{{item.Id}}">
                            <view class="recommend-emoij"></view>
                     </view>
                     <view class="recommend-imgae-wrap recommend-wrap" catchtap="selectImg" data-id="{{item.Id}}">
                            <view class="recommend-img"></view>
                     </view>
                    <!-- 
                    <view class="recommend-voice-wrap recommend-wrap">
                      <view class="recommend-voice"></view>
                    </view>
                    -->
                  </view>
                  <view class="recommend-submit-container">
                        <view class="recommend-cancle-wrap recommend-wrap" catchtap="commentCancle">取消</view>
                        <view class="recommend-submit-wrap recommend-wrap" catchtap="commentSubmit" data-id="{{item.Id}}">发表</view>
                  </view>
              </view>
              <view class="post-qq-face bz clearfix" style="{{emoij.id==item.Id?'display:block':'display:none'}}">
                    <template is="emoij" />
              </view>
              <view style="clear:both"></view>
          </view>
        </view>
      </view>
    </block>
  </view>
</view>
  <view class="loading" style="display:{{loading?'block':'none'}}">
    <image style="height:16px; width:16px;" src="http://i.pengxun.cn/content/images/loading.gif"></image>
    <view class="loading">正在加载...</view>
  </view>

<!--<view class="comment-voice-container">
   <view class="audio-wrap">
      <audio id="test" class="audio" name="此时此刻" controls   poster="http://i.pengxun.cn/content/images/voice/voiceplaying.png" 
      src="http://shop.vzan.com/t.mp3"></audio>
  </view>
</view>
-->