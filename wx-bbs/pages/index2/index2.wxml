<import src="/template/postlist"/>
<import src="/template/emoij"/>
<view class="page-container">
    <view class="head-container">
        <view class="head-container-wrap">
            <view class="head-img-wrap" style="background: url({{headinfo.obj.BackMap}}) no-repeat;"></view>
            <view class="head-logo-container z-index2">
                <view class="head-info-wrap">
                    <image style="width:120rpx; height:120rpx;" src="{{headinfo.obj.LogoUrl}}"></image>
                </view>
                <!-- 浏览量 -->
                <view class="head-info-wrap">
                    <text class="font-13rem font-family head-info">话题 {{headinfo.obj.ArticleCount}} | 访问 {{headinfo.obj.ClickCount}}</text>
                </view>
            </view>
        </view>
        <!-- 签到关注 -->
        <view class="head-sign-container">
            <view wx:if="{{!user.obj.IsSign}}" class="head-sign-wrap" >
                <view class="index-sign"></view>
                <text class="font-13rem font-family ">签到</text>
            </view>
            <view  class="head-sign-wrap" >
                <view class="index-concern"></view>
                <text class="font-13rem font-family">关注</text>
            </view>
            <view wx:if="{{user.obj.IsWholeAdmin}}" class="head-sign-wrap" >
                <view class=""></view>
                <view></view>
            </view>
        </view>
        <view style="width:100%;height:20rpx;"></view>
        <!-- 版块 -->
        <view style="position:relative">
            <scroll-view scroll-x="true" style="width:100%;height:40px;" scroll-left="{{scrollLeft}}" class="category-container">
                <view class="cateogry {{currentTypeId==0&&hot==0?'selected':''}}" catchtap="toBankuai" data-typeid="0">全部</view>
                <view class="cateogry {{currentTypeId==0&&hot==1?'selected':''}}" catchtap="toBankuai" data-typeid="0" data-hot="1" >热帖</view>
                <block wx:for="{{headinfo.obj.Categories}}" wx:for-item="categoryItem" wx:key="Id">
                    <view class="cateogry {{ currentTypeId==categoryItem.Id?'selected':''}}" catchtap="toBankuai" data-typeid="{{categoryItem.Id}}" >{{categoryItem.Title}}</view>
                </block>         
            </scroll-view>
            <!-- 更多版块 -->
            <view class="arrow-wrap" catchtap="moreType">
                <view class="arrow"></view>
            </view>
        </view>
    </view>
    <view style="width:100%;height:20rpx;"></view>
    <!-- 帖子 -->
    <view class="articles-container">

        <block wx:for="{{articles}}" wx:for-item="article" wx:key="Id">
            <view>
                <include src="/template/article-user.wxml"/>
                <include src="/template/article-post.wxml"/>
                <include src="/template/article-icon.wxml"/>
                <include src="/template/article-reward.wxml"/>
                <include src="/template/article-praise.wxml"/>
                <include src="/template/article-comment.wxml"/>
                <include src="/template/article-recomment.wxml"/>
            </view>
            <view style="width:100%;height:20rpx;background-color:#f5f5f5"></view>
        </block>
    
    </view>
    <view class="loading" style="display:{{loading?'block':'none'}}">
        <image style="height:16px; width:16px;" src="http://i.pengxun.cn/content/images/loading.gif"></image>
        <view class="loading">正在加载...</view>
    </view>
   <!-- 版块 -->
    <view class="fix-category-container">
        <scroll-view scroll-x="true" style="width:100%;height:40px;" scroll-left="{{scrollLeft}}" class="fix-category-wrap">
            <view class="cateogry {{currentTypeId==0&&hot==0?'selected':''}}" catchtap="toBankuai" data-typeid="0" >全部</view>
            <view class="cateogry {{currentTypeId==0&&hot==1?'selected':''}}" catchtap="toBankuai" data-typeid="0" data-hot="1" >热帖</view>
            <block wx:for="{{headinfo.obj.Categories}}" wx:for-item="categoryItem" wx:key="Id">
                <view class="cateogry {{ currentTypeId==categoryItem.Id?'selected':''}}" catchtap="toBankuai" data-typeid="{{categoryItem.Id}}" >{{categoryItem.Title}}</view>
            </block>         
        </scroll-view>
        <view class="arrow-wrap" catchtap="moreType">
            <view class="arrow"></view>
        </view>
    </view>

</view>


<!-- 评论 -->
<view wx:if="{{showRecomment}}" class="recomment-container" >
    <view catchtap="commentCancle" style="width:100%;height:100%"></view>
    <view class="recomment-wrap">
        <!-- 图片 -->
        <!-- 发帖图片 -->
        <form bindsubmit="submit">
            <view style="margin:12px;">
                <block wx:for="{{selectedImgs}}" wx:for-item="imgs">
                    <view style="position:relative;max-height:80px; width:20%; margin:5px; display:inline-block; vertical-align:middel">
                        <view class="img-remove" data-id="{{imgs.id}}" catchtap="removeImg"></view>
                        <image style="width:100%;max-height:80px;" src="{{imgs.src}}"/>
                    </view>
                </block>
            </view>
            <view style="width:100%; padding:5px;">
                <!--<textarea bindfocus="saveTextValue" class="recommend-text" placeholder="{{showRecommend.toUserName?'回复'+showRecommend.toUserName+':':'回复帖子:'}}" value="{{commentText}}" bindblur="saveTextValue"></textarea>-->
                <textarea  style="border: 1px solid #d6d6d6;background-color:#fff" 
                    bindinput="saveTextValue" class="recommend-text" 
                    placeholder="{{showRecomment.toUserName?'回复' + showRecomment.toUserName + ':' :'回复帖子:'}}" 
                    value="{{commentText?'':commentText}}"/>
            </view>
            <view class="recommend-line-container">
                <view class="recommend-icon-container">
                    <view class="recommend-emoij-wrap recommend-wrap" catchtap="selectEmoij">
                        <view class="recommend-emoij"></view>
                    </view>
                    <view class="recommend-imgae-wrap recommend-wrap" catchtap="selectImg">
                        <view class="recommend-img"></view>
                    </view>
                <!-- 
                <view class="recommend-voice-wrap recommend-wrap">
                <view class="recommend-voice"></view>
                </view>
                -->
                </view>
                <view class="recommend-submit-container">
                    <button class="recommend-cancle-wrap recommend-wrap" catchtap="commentCancle">取消</button>
                    <button class="recommend-submit-wrap recommend-wrap" form-type="submit" catchtap="commentSubmit">发表</button>
                </view>
                </view> 
        </form>
    </view>
    <!--<view class="post-qq-face bz clearfix" style="{{emoij.id==item.Id?'display:block':'display:none'}}">
        <template is="emoij" />
    </view>-->
    <view style="clear:both"></view>
</view>